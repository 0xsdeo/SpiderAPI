---
title: ADB 命令
date: 2020-05-14 11:39:45
permalink: /pages/adb
article: false
---

::: tip
ADB（Android Debug Bridge）是一个命令行工具，可与模拟器或连接的 Android 设备进行通信，可以下载 [SDK Platform Tools](https://developer.android.com/tools/releases/platform-tools) 获取 ADB 工具。
:::

## ADB Debugging

### adb kill-server

关闭 ADB 服务：

```shell
adb kill-server
```

### adb start-server

启动 ADB 服务：

```shell
adb start-server
```

### adb devices

查看连接设备：

```shell
adb devices
```

查看连接设备，`-l` 表示长输出：

```shell
adb devices -l
```

### adb forward

列出所有 socket 连接：

```shell
adb forward --list
```

设置端口转发，将计算机端口 6123 转发到 Android 设备端口 7123：

```shell
adb forward tcp:6123 tcp:7123
# adb forward [远程端协议：端口号] [设备端协议：端口号]
```

## 无线连接

### adb connect

Step 1：在电脑端指定 Android 设备的 TCP/IP 端口，断开 USB 与 Android 设备的连接：

```shell
adb tcpip 5555
```

Step 2：在“设置”>“关于手机”>“状态信息”>“IP 地址”中找到 Android 设备的 IP 地址，通过 Wi-Fi 连接到设备：

```shell
adb connect 192.168.1.184:5555
```

Step 3：确认已通过 Wi-Fi 连接到 Android 设备：

```shell
adb devices
# List of devices attached
# 192.168.1.184:5555 device
```

### adb usb

在USB模式下重新启动

```shell
adb usb
```

## APK 包管理

### adb install

将单个 APK 推送到设备并安装：

```shell
adb install spiderapi.cn.apk
```

将单个软件的多个 APK 推送到设备，然后当作一整个 apk 进行安装：

```shell
adb install-multiple spiderapi.cn.apk spiderapi.cn.arm64.apk
```

将单个软件的多个 APK 推送到设备，然后当作一整个 apk 以原子方式进行安装：

```shell
adb install-multi-package spiderapi.cn.apk spiderapi.cn.arm64.apk
```

替换现有应用程序，重新安装现有应用程序，保留其数据：

```shell
adb install -r spiderapi.cn.apk
```

允许测试包：

```shell
adb install -t spiderapi.cn.apk
```

允许 APK 进行降级安装，正常是不被允许：

```shell
adb install -d spiderapi.cn.apk
```

为应用程序授予所有运行时的权限：

```shell
adb install -g spiderapi.cn.apk
```

使应用程序作为临时安装应用程序安装：

```shell
adb install --instant spiderapi.cn.apk
```

使用快速部署：

```shell
adb install --fastdeploy spiderapi.cn.apk
```

允许将 apk 推送到设备并作为单独的步骤调用包管理器：

```shell
adb install --no-streaming spiderapi.cn.apk
```

### adb uninstall

卸载 app：

```shell
adb uninstall spiderapi.cn.apk
```

卸载 app 后保留数据和缓存目录：

```shell
adb uninstall -k spiderapi.cn.apk
```

### adb shell pm list packages

列出所有应用程序，包括系统应用和用户安装的应用：

```shell
adb shell pm list packages
```

列出所有应用程序包的包名以及其对应的文件路径（file）：

```shell
adb shell pm list packages -f
```

列出所有（all）应用程序的详细信息，包括系统应用和用户安装的应用，但不包括 APXes（Android Pony EXpress）：

```shell
adb shell pm list packages -a
```

仅列出 APEX 包：

```shell
adb shell pm list packages --apex-only
```

列出已经被禁用的（disabled）应用程序包：

```shell
adb shell pm list packages -d
```

列出已经被启用的（enabled）应用程序包：

```shell
adb shell pm list packages -e
```

列出系统自带的（system）应用程序包：

```shell
adb shell pm list packages -s
```

列出第三方（third party）应用程序包：

```shell
adb shell pm list packages -3
```

列出应用程序包的安装器信息（installer）：

```shell
adb shell pm list packages -i
```

列出被忽略（ignored）（用于与旧版本的兼容）的应用程序包：

```shell
adb shell pm list packages -l
```

列出应用程序包的 UID：

```shell
adb shell pm list packages -U
```

仅列出指定 UID 的包：

```shell
adb shell pm list packages --uid UID
```

列出未安装的（uninstalled）应用程序包：

```shell
adb shell pm list packages -u
```

显示版本代码：

```shell
adb shell pm list packages --show-versioncode
```

仅列出属于指定用户的包：

```shell
adb shell pm list packages --user USER_ID
```

### adb shell pm path

查看某个安装包的路径：

```shell
adb shell pm path com.spiderapi.cn
```

### adb shell pm clear

删除与包相关的所有数据（app 的数据和缓存）:

```shell
adb shell pm clear com.spiderapi.cn
```
