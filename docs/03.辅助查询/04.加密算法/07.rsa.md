---
title: RSA
date: 2020-05-14 11:39:45
permalink: /pages/rsa
article: false
---

::: details 关于 RSA 非对称加密算法
RSA 加密算法是一种非对称加密算法，是由罗纳德·李维斯特（Ron Rivest）、阿迪·萨莫尔（Adi Shamir）和伦纳德·阿德曼（Leonard Adleman）在 1977 年一起提出的，RSA 就是他们三人姓氏开头字母拼在一起组成的。RSA 公开密钥密码体制的原理是：根据数论，寻求两个大素数比较简单，而将它们的乘积进行因式分解却极其困难，因此可以将乘积公开作为加密密钥。RSA 相关专业术语以及解释如下：

<!--填充方式（padding）：
- `RSA_PKCS1_PADDING`: 使用 PKCS #1 v1.5 填充方案；
- `RSA_PKCS1_OAEP_PADDING`: 使用 OAEP 填充方案；
- `RSA_NO_PADDING`: 不使用填充方案。需要手动处理输入数据的长度；
- `RSA_PKCS1_PSS_PADDING`: 使用 PSS (Probabilistic Signature Scheme) 填充方案。
-->

::: right
RSA [维基百科](https://en.wikipedia.org/wiki/RSA_(cryptosystem))
:::

::: danger 注意
RSA 加解密涉及到密钥位数、密钥格式、密钥语法标准、填充方式等概念，请务必理解后再进行使用，否则可能在使用代码时发生各种报错，认真阅读文档，可解决 99% 的问题！！！
:::

## 生成密钥

::: details 关于密钥各个术语的解释
<mark>什么是密钥的位数：</mark>
<br/>

该位数既不是指公钥的长度，也不是私钥的长度，实际上是指生成的 RSA 密钥对中公钥和私钥所包含的模数（modulus）的位数，给定一个公钥或者私钥，均可从中解析出模数，由于 RSA 密钥对是基于一个大素数乘积生成的，因此长度也决定了其安全性和加密强度，在实际使用中，密钥位数常见的有 512 位、1024 位、2048 位、3072 位和 4096 位。但实际应用中不推荐 512 位，需要注意的是，密钥长度越长，加密的强度也就越强，但同时也会增加程序计算的时间。例如，秘钥长度增加 1 倍，密钥对生成的时间就增加 16 倍，公钥加密操作时长增加 4 倍，私钥解密操作时长增加 8 倍。因此，选择密钥长度时需要综合考虑安全性和效率。

---
<mark>什么是模数（modulus）：</mark>
<br/>

RSA 密钥的模数是公钥和私钥中的一个重要参数，通常用大素数的乘积表示，在 RSA 加密算法中，模数（modulus）是两个大素数的乘积，通常用 N 表示，在密钥生成过程中，选择两个大素数 p 和 q，然后计算它们的乘积 $N = p * q$，这个 N 就是 RSA 密钥的模数，模数 N 用于 RSA 算法中的加密、解密、签名和验证过程，公钥由模数 N 和公钥指数 e 组成，私钥由模数 N 和私钥指数 d 组成。模数 N 的长度通常决定了 RSA 密钥的安全性。

---

<mark>什么是公钥 / 私钥指数：</mark>
<br/>

在 RSA 加密算法中，公钥和私钥都包含一个指数，这些指数是用来进行加密和解密操作的，公钥指数通常用 e 表示，私钥指数通常用 d 表示，这两个指数的选择是相互关联的，确保了 RSA 算法的正确性，通常情况下，公钥指数 e 和私钥指数 d 满足以下条件：$e*d≡\phi(N)$，其中 $\phi(N)$ 是欧拉函数，用于计算与模数 N 互素的正整数个数。这个条件保证了 RSA 加密和解密过程是可逆的，公钥指数 e 通常为 65537（0x10001，5bits），该值是除了 1、3、5、17、257 之外的最小素数，私钥指数 d 可以通过公钥指数 e 和模数 N 计算得到，一种常用的方法是使用扩展的欧几里得算法或模反演算法，这两种方法都可以有效地计算私钥指数 d，根据前面提到的两个指数关系的公式，可以得到：$\phi(N)=(p−1)(q−1)$，所以私钥指数 d 应当是一个大整数，并且满足 $1<d<\phi(N)$。一般在各个 RSA 加解密代码里，都不用单独设置这公钥指数，基本上都是默认的 65537（0x10001，5bits）。

---

<mark>私钥签名（加密）：</mark>
<br/>

私钥签名，也称为私钥加密，私钥通常用于对敏感数据进行解密，如果私钥未经授权的访问者获得，可能会导致数据泄露或伪造签名等安全问题，通过加密私钥，即使未经授权的人获得了密钥文件，也需要正确的解密密码才能访问私钥，从而保护私钥的安全。在生成密钥对时，可以指定加密私钥的算法和密码，在使用私钥时，需要提供正确的解密密码才能解密私钥。

---

<mark>密钥输出的格式：</mark>

- `der`：二进制数据，序列化 [ASN.1](https://en.wikipedia.org/wiki/ASN.1#Example_encoded_in_DER) 结构；
- `pem`：最常见的类型，将 der 数据进行 base64 编码，然后加上以 `-----` 包裹的标头，用于标识密钥类型；
- `jwk`：JSON Web 密钥，关键数据存储在 JSON 对象中，是 JavaScript 对象签名和加密 (JOSE) 规范的一部分；
- `openssh`：OpenSSH 密钥格式，常用于在 OpenSSH 客户端和服务器之间传输密钥，密钥以 `ssh-rsa` 开头。

---

<mark>密钥的语法标准：</mark>
- 公钥语法标准：`pkcs1` 或 `spki`
- 私钥语法标准：`pkcs1` 或 `pkcs8`

有的库里面（如：JS 的 `node-rsa` 库），公钥语法标准支持 `pkcs1` 或 `pkcs8`，没有 `spki`，事实上这是不太规范的说法，参见 [issues](https://github.com/rzcoder/node-rsa/issues/208)。

当密钥输出格式为 `pem` 时：

- 公钥使用 `pkcs1` 标准，得到的公钥以 `-----BEGIN RSA PUBLIC KEY-----` 开头；
- 公钥使用 `spki` 标准，得到的公钥以 `-----BEGIN PUBLIC KEY-----` 开头；
- 私钥使用 `pkcs1` 标准，得到的私钥以 `-----BEGIN RSA PRIVATE KEY-----` 开头；
- 私钥使用 `pkcs8` 标准，得到的私钥以 `-----BEGIN PRIVATE KEY-----` 开头。
- 私钥使用 `pkcs1` 标准，如果对私钥进行了加密，则得到的私钥包含 `Proc-Type`、`DEK-Info` 字段；
- 私钥使用 `pkcs8` 标准，如果对私钥进行了加密，则得到的私钥以 `-----BEGIN ENCRYPTED PRIVATE KEY-----` 开头。

---

<mark>pkcs 标准科普：</mark>

[公钥加密标准（Public Key Cryptography Standards, PKCS）](https://en.wikipedia.org/wiki/PKCS)，是由美国 RSA 数据安全公司及其合作伙伴制定的一组公钥密码学标准，其中包括证书申请、证书更新、证书作废表发布、扩展证书内容以及数字签名、数字信封的格式等方面的一系列相关协议。PKCS#1 至 PKCS#15 是不同类型的标准，用于不同的场景，在 RSA 算法中主要会用到 PKCS#1 和 PKCS#8 两种标准：
- PKCS#1：专门针对 RSA 算法的一个标准，用于 RSA <font color=red>**公钥和私钥**</font>的具体实现以及加密、签名算法的规定；
- PKCS#8：通用<font color=red>**私钥**</font>语法标准，定义了私钥的存储格式，可以用于不同密码学算法的私钥存储。

---

<mark>spki 标准科普：</mark>

- [公开密钥基础设施（Public Key Infrastructure, PKI）](https://en.wikipedia.org/wiki/Public_key_infrastructure)，又称公开密钥基础架构、公钥基础建设、公钥基础设施、公开密码匙基础建设或公钥基础架构，是一组由硬件、软件、参与者、管理政策与流程组成的基础架构，其目的在于创造、管理、分配、使用、存储以及撤销数字证书；
- [简单公钥基础设施（Simple public-key infrastructure, SPKI）](https://en.wikipedia.org/wiki/Simple_public-key_infrastructure)，是克服传统 X.509 PKI 复杂性的一种尝试，SPKI 规范定义了授权证书格式，提供了特权、权利或其他此类属性（称为授权）的描述，并将它们绑定到公钥。

---

::: right
【实用参考资料】

公钥证书编码解读：[https://zhuanlan.zhihu.com/p/77329250](https://zhuanlan.zhihu.com/p/77329250)<br/>
RSA密钥长度、明文长度和密文长度：[https://cloud.tencent.com/developer/article/1199963](https://cloud.tencent.com/developer/article/1199963)<br/>
安全：深入理解数字证书中的 PKCS#1 与 PKCS#8 标准 ：[https://cloud.tencent.com/developer/article/2390956](https://cloud.tencent.com/developer/article/2390956)<br/>
PKCS#1、PKCS#5、PKCS#7、PKCS#8 到底是什么？：[https://blog.csdn.net/weixin_45264425/article/details/127096145](https://blog.csdn.net/weixin_45264425/article/details/127096145)
:::

### Python <Badge text="3.0+"/>

<code-group>
  <code-block title="生成密钥（推荐）1️⃣" active>
  ```python
  # ✅ 安装依赖 pip install pycryptodome，官方文档：https://pycryptodome.readthedocs.io/

  # ❌ 密钥输出格式不支持 jwk
  # ❌ 公钥语法标准不支持 pkcs1，仅支持 spki
  # ❌ 私钥加密：当私钥语法标准为 pkcs1 时，不支持指定算法，默认使用 DES-EDE3-CBC
  #             当私钥语法标准为 pkcs8 时，protection 可以指定算法，算法名称参考：https://pycryptodome.readthedocs.io/en/latest/src/io/pkcs8.html#encryption-parameters
  
  from Crypto.PublicKey import RSA
  
  
  key = RSA.generate(
      bits=2048,                           # 密钥位数，即模数（modulus）的位数，常见的有 512 位、1024 位、2048 位、3072 位和 4096 位
      e=65537                              # 公钥指数，默认 65537（0x10001），该值是除了 1、3、5、17、257 之外的最小素数
  )
  
  private_key = key.export_key(
      format="PEM",                        # 私钥输出格式，支持 pem、der、openssh
      pkcs=8,                              # 私钥语法标准，支持 pkcs1、pkcs8，该参数仅对私钥有效
      # passphrase="spiderapi",            # 可选参数，私钥加密的密码，如果私钥加密了，则使用时需要先解密，该参数仅对私钥有效
      # protection="scryptAndAES128-GCM",  # 可选参数，私钥加密的算法，该参数仅对私钥，且 pkcs=8 时有效
  )
  public_key = key.publickey().export_key(
      format="PEM",                        # 公钥输出格式，支持 pem、der、openssh，公钥语法标准，仅支持且默认 spki
  )
  
  print("RSA 公钥（spki、pem）：\n\n", public_key.decode("utf-8"))
  print("RSA 私钥（pkcs8、pem）：\n\n", private_key.decode("utf-8"))
  
  """
  RSA 公钥（spki、pem）：
  
  -----BEGIN PUBLIC KEY-----
  MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4MIESlYLQMhXeh1AsIxi
  XqdbyG6hMo7feRu2CsvH14iYdwaxMZ2gV3PBu+Z9gCD+zoreO4PYMqpn0koXGg2n
  VRhTZVzJARVnLokmK3wVFYx2ooubABFv/duL30LzHi2qheXIz5etB0XjOPz1A9D3
  OngaHH6YnyoCos0KtDbaiNOdYY2lh5tXG8JV4yaHGmPgHLYjp19EBOYaqiXj89Ut
  GtTvc/bl6pO1uZbsR70zZY2yU79+B7UGhsMHTcFdZ7XokLk2uwUoKRYvsD1S/pEX
  xIYwq1DJZ4/SMAidVe58jwPEg9Vonb/HZX24l35PSDDKC52oUaEynQcdvnHJoJM9
  hwIDAQAB
  -----END PUBLIC KEY-----
  
  RSA 私钥（pkcs8、pem）：
  
  -----BEGIN PRIVATE KEY-----
  MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQDgwgRKVgtAyFd6
  HUCwjGJep1vIbqEyjt95G7YKy8fXiJh3BrExnaBXc8G75n2AIP7Oit47g9gyqmfS
  ShcaDadVGFNlXMkBFWcuiSYrfBUVjHaii5sAEW/924vfQvMeLaqF5cjPl60HReM4
  /PUD0Pc6eBocfpifKgKizQq0NtqI051hjaWHm1cbwlXjJocaY+ActiOnX0QE5hqq
  JePz1S0a1O9z9uXqk7W5luxHvTNljbJTv34HtQaGwwdNwV1nteiQuTa7BSgpFi+w
  PVL+kRfEhjCrUMlnj9IwCJ1V7nyPA8SD1Widv8dlfbiXfk9IMMoLnahRoTKdBx2+
  ccmgkz2HAgMBAAECggEACSTA0Zi0MX5VAgycRp0XcrwClwyvyyOWgidMncjSMvmw
  INt+rELk3y9AOO7fY9iJH970u91ubLU+WbGWRK2R2qY4MlNMLBqc+CmFNNdXRj6m
  JDu4t7p94LPPT2sPrUZ0qFODpV+0HtZ1hX/TpJmaN+CN82MlE13n/eEzPRykLFUY
  DVhXcVYlMamHCtNT9039ByEBF7kIeODhLPYgKAcwCOY8f4fQqEDZUfshbHdOlAt+
  Bx9bOToSPqNYMIrzHk/SrUfjI2+x3mVZY5PSSxyBRObroKVd4V+De+bXUyLhdnpC
  RmH8JWsFEcfSILMSlkrfA+xGag36oXTD8wtf19X9XQKBgQDqMQ+B3fiicVLirdLx
  PB0OD4U2noitzkyjr+qZYx3VpIRu+eK1q9esJ9KYzBUEdfTCXaKHHVcjZ/IErOsZ
  eFcBS2Fwwpa3GMeOJ4hTcNuzBIsp6D/g6PwSF4I/lGXTSCep7YEgoana3VItKlqx
  FbweB1guMpzS0jpWKVAPFAG3KwKBgQD1sBAXTqZqXcaVLkgZaowdFA2maFDpNp0b
  tiyGcyRAhYHdbb4TBFrgSDCYdnMpQMo0H4YmqRQFI38r5ROOsSQDcTNwMf6E9nUX
  QlZu1DBri0vnGgbjRTuKIDUEadVrCepCHfYyX7yEMg1vkCqdoknqFICn38R48Gq9
  Ab66m+IlFQKBgBv3M9TcPt6XDcDH5RKtjQKq08uL7uJiakB5t1gNv/hNJwthh7MO
  DDkgoENiy3e25j13lPrxhABUX1AznfdyqWEcMUyX0AuZR+svyVW9el7MQhoFA+vF
  pqQ6bnFNNUOfsCzYkbzl0TSzjSabkiznXYlwcxVBMfzy4ch8MnU6fGH1AoGAZg3/
  cR8Lg412istRybT3hLCqxt/4FBfKhRNURXkYqvCKNEd8t/uMIDP8c6hoR8+Q7rvV
  hsOe/E91aO9cA17TvdZM7qLlvad+le3JZ3oert2K5vFpwQgmJkcgnrezniXdOB+n
  /97CuQrth9UTzqz2FRT1KEaMH0yGmgJajrtn4c0CgYA7N7XM7oI6oH5uG0c2bcNT
  oF6CbMKKY6IRmpyrTeozRrNo/luA0v89o6ETdeC/hChzVh66oECz9KW/XVXFyttt
  8sOTwXEsdWE4A7oNOM1vQhx7DtKJpqtvZFAxrVhgYyuaZSAEc2isWKhIPWq2mjKD
  pByL7lrJPDv9Z7za63nMBQ==
  -----END PRIVATE KEY-----
  """
  ```
  </code-block>

  <code-block title="生成密钥 2️⃣">
  ```python
  # ✅ 安装依赖 pip install cryptography，要求 Python 3.7+，官方文档：https://cryptography.io/

  # ❌ 密钥输出格式不支持 jwk
  # ❌ 私钥语法标准不支持 pkcs1
  
  from cryptography.hazmat.primitives.asymmetric import rsa
  from cryptography.hazmat.primitives import serialization
  from cryptography.hazmat.primitives.ciphers import algorithms
  
  
  private_key = rsa.generate_private_key(
      public_exponent=65537,                                 # 公钥指数，推荐 65537（0x10001），该值是除了 1、3、5、17、257 之外的最小素数
      key_size=2048                                          # 密钥位数，即模数（modulus）的位数，常见的有 512 位、1024 位、2048 位、3072 位和 4096 位
  )
  
  # 从私钥中提取公钥
  public_key = private_key.public_key()
  
  # 序列化私钥和公钥
  public_key = public_key.public_bytes(
      encoding=serialization.Encoding.PEM,                    # 公钥输出格式，支持 pem、der、openssh
      format=serialization.PublicFormat.SubjectPublicKeyInfo  # 公钥语法标准，支持 pkcs1、spki (SubjectPublicKeyInfo)
  )
  
  
  private_key = private_key.private_bytes(
      encoding=serialization.Encoding.PEM,                    # 私钥输出格式，支持 pem、der、openssh
      format=serialization.PrivateFormat.PKCS8,               # 私钥语法标准，支持 pkcs8
      encryption_algorithm=serialization.NoEncryption()       # 私钥不加密
      # encryption_algorithm=serialization.BestAvailableEncryption("password".encode())  # 对私钥加密
  )
  
  print("RSA 公钥（spki、pem）：\n\n", public_key.decode("utf-8"))
  print("RSA 私钥（pkcs8、pem）：\n\n", private_key.decode("utf-8"))
  
  
  """
  RSA 公钥（spki、pem）：
  
  -----BEGIN PUBLIC KEY-----
  MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAunWw+FBw3WGzKuU9tyoP
  0UWn0FOD5N7vlfhjFn0FUkeMQlgPqj+4uxNnayMA4Qxj9UeMS/N9+dN8KfIWnvjg
  R+UBsSgqZuy/ONx9E23ycq6l2RjGbdIKcRSsmmEKcAjCQub/EglWhzhacwLB4nr/
  HQvQS2x/J5NwR9WD8VWoYPICIa+LUSNZAbbA29Fitj7njbJkJbhNX4aaHUSQpWFG
  djoFyGmpXb1HhaswmaC1jtZo5xzQfuSIeCq21VNWS2wvKdqcHg7jNbhhst54H3W5
  O7Qg7IYiGseYLO2m6f4NxLuhFDfdDHjSNDONzgGvm1fAI1Xs1r01BTx0n3DfSbqz
  AQIDAQAB
  -----END PUBLIC KEY-----
  
  RSA 私钥（pkcs8、pem）：
  
  -----BEGIN PRIVATE KEY-----
  MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQC6dbD4UHDdYbMq
  5T23Kg/RRafQU4Pk3u+V+GMWfQVSR4xCWA+qP7i7E2drIwDhDGP1R4xL833503wp
  8hae+OBH5QGxKCpm7L843H0TbfJyrqXZGMZt0gpxFKyaYQpwCMJC5v8SCVaHOFpz
  AsHiev8dC9BLbH8nk3BH1YPxVahg8gIhr4tRI1kBtsDb0WK2PueNsmQluE1fhpod
  RJClYUZ2OgXIaaldvUeFqzCZoLWO1mjnHNB+5Ih4KrbVU1ZLbC8p2pweDuM1uGGy
  3ngfdbk7tCDshiIax5gs7abp/g3Eu6EUN90MeNI0M43OAa+bV8AjVezWvTUFPHSf
  cN9JurMBAgMBAAECggEBAKydjcKjvYjFDLf2V0b88n27LVsIJb84v7Ynp5vHC6kb
  QXadzYq/yQWvNfuSARtWfCczIGejuAkSxwyR6G0tW3xTPljCJVb5byF1xXi6PUv7
  8N9lNzWt0CrVh+C3W5FSGn0TGimZaXhvLBTzBYjkcs5yBFf+zkxWCwkFWkuOD/4G
  F9sCAzdrxbHkn1qpbPBCf4NIJ3ETApD3AMFuZol+GzAz1E6xaCupCqf1+yjWGjhE
  VjPA6MPx/RqPxI/Xn2BsX9nNEfsyxHmffbG9Hnu487ByOZFOdw/5JWsgCuhnX/0I
  cERAhuuXtjya9NuJkMrXGnoXofc7Om79oE0blcXSb60CgYEA5vhlGkaXeduFHJNa
  2ATDXrYGO1vEYR3fmxUKE7VYjGWZBzaUAQBFc+KFlpj6/587Hyldi6xG+PUWrMzS
  nMDSEgZY+3WdyE9DmUOjp2Mf8sPQYRob3T7osL7ttyaMB5Fv+Rap/HuRla/2FAR7
  77nvFsaGmUW+w4YuVWxKjUcVWMsCgYEAzqp6qBdFugCXwZyIasucqI2DKOocnfbR
  Rbk0lcpyz2Fl6CqPUc1eJUesoOxZuvShMGpeqWPwiD97lsI6BJ5P7ymalR3XaGBr
  nNineop0a2sxj4cbEEcxOXJfl46+MDmDY9n0kOFzULwm0cP1m0VFjMmTLXGnsCRZ
  SVQFGMATBeMCgYBhF/54Y0B+K3fzoUZJFQeEIwTPoy4UnVhIezm3Oz60FmmUDK9/
  FDweERWTT1AEcU2LNfprIsrbETys+5V16+DjTuPNIY5ojFmgbjy3uwXNKd/JUg5w
  nWd4FWsc2Ql4jP0DOzHOP6vdvxC1LYVkK0eEzYP7nsQosZl8s39LkJw6rQKBgFYh
  8zDvUh4tdRI6XRi1d7tAD3QT7o1feuTmRaZQU/1eiIx0gHsFbsF219nR56vlnPCC
  xKUwg+UlICs7E9cs6/+vhT+0yjw0Q2WBXnvSDKdga614D61/HmLk6jZORbHvpnUN
  N8LSU69IW519YHWwL0Z4FKESB2OAIr5PCDjChKslAoGBAIe5+HFJyOZTt3Urzwzc
  7h8q97z+DXRChzTiBv8KaM3hknmKYc9qoGpOK6FqM8GcotvI55ZGlixJtmy1GMRf
  nk1qENc23oadYBEzAcQA5+0me/QDxk0q0BdkDkaNH2NA6lMY/4TriNde/fSY7Dil
  bDVst9Y7yqL41PYRWM/rhWas
  -----END PRIVATE KEY-----
  """
  ```
  </code-block>

  <code-block title="生成密钥 3️⃣">
  ```python
  # ✅ 安装依赖 pip install rsa，官方文档：https://stuvel.eu/python-rsa-doc/

  # ❌ 密钥输出格式不支持 jwk、openssh
  # ❌ 公钥语法标准不支持 spki
  # ❌ 私钥语法标准不支持 pkcs8
  # ❌ 不支持对私钥进行签名、加密
  
  import rsa
  
  
  (public_key, private_key) = rsa.newkeys(
      nbits=1024,        # 密钥位数，即模数（modulus）的位数，常见的有 512 位、1024 位、2048 位、3072 位和 4096 位
      exponent=65537     # 公钥指数，默认 65537（0x10001），该值是除了 1、3、5、17、257 之外的最小素数
  )
  
  # 公钥和私钥输出各种都仅支持 pem 和 der，语法标准都只支持 pkcs1
  public_key = public_key.save_pkcs1(format="PEM")
  private_key = private_key.save_pkcs1(format="PEM")
  
  print("RSA 公钥（pkcs1、pem）：\n\n", public_key.decode("utf-8"))
  print("RSA 私钥（pkcs1、pem）：\n\n", private_key.decode("utf-8"))
  
  """
  RSA 公钥（pkcs1、pem）：
  
  -----BEGIN RSA PUBLIC KEY-----
  MIGJAoGBALLA/aUElSxqvPUnlC4A8UaNh6txyrjlLshW4/wUgWZIBBbvp7yVj4Oi
  C5mbbbyvOqElQNhkaeV8EF2rZqy9m5whs+jIx1tUdyJPJXLyZCNr3Q8t4sQyek6q
  1+imN6KUEIHrLveuYq1Lvmw3lt52vRzvWwucYV0EHSbx3G0b6hErAgMBAAE=
  -----END RSA PUBLIC KEY-----
  
  RSA 私钥（pkcs1、pem）：
  
  -----BEGIN RSA PRIVATE KEY-----
  MIICYAIBAAKBgQCywP2lBJUsarz1J5QuAPFGjYerccq45S7IVuP8FIFmSAQW76e8
  lY+DoguZm228rzqhJUDYZGnlfBBdq2asvZucIbPoyMdbVHciTyVy8mQja90PLeLE
  MnpOqtfopjeilBCB6y73rmKtS75sN5bedr0c71sLnGFdBB0m8dxtG+oRKwIDAQAB
  AoGADOrlaYdrQEp2XUD+9FQdG3we0cTnYXUubEvbLdxNfZa2tPGcrYQhWuHa9L7G
  r1v6YKrQhNK81Fii1iIMvBnzkVIakhSYvC294yyEZG+fYJcXuZWzoF0+YUrlFP0b
  vG5JOpDcUN4YG+tG924AbhyPL0AJkX0BEElSWaFhVtnTxAECRQC4fMLIzE2hCq9F
  UmR59YDSHasPUVDWuq0eXG+P/0Kp9x5ZUDjZcojcBhpsJBQbx9P4ygyiYj4uUw3O
  SA8X/fZHxqmg/QI9APgLR5Uz5Veaj1PguhkoKB3384PnrrKoFD+wgc6H7Qib9aKG
  KT0x5dKswZefyE/PF+Qi7hMWiO18FK2HRwJEb/eQREvyhV21uE3kGzzL3ToSWq6Q
  cHJFpVqWfv9+Fyea7LvKdPaVZ2vw11ciOSYTWThPaLJVaMoRY/PJ7Va+BRvmUYUC
  PQCO06fnYReZRxVq3gcqvzXCc+kTtg+hLilitxc3vosdnvhlGk2awCWvFuzuiwID
  +qKuKfLeqOY1oXIirbcCRGtG4PspKLAQMO6jI7bFUc5if9UKo6TGeu39E3qtv4jW
  NW6qObPBJ9R1gurMqPUT9g630xjZdZxz6ac9Z7FfgjpMV0Fe
  -----END RSA PRIVATE KEY-----
  """
  ```
  </code-block>
</code-group>

### JavaScript <Badge text="Node.js"/> <Badge text="ECMAScript 5.1+"/>

<code-group>
  <code-block title="生成密钥（推荐）1️⃣" active>
  ```javascript
  // ✅ Node.js 内置 crypto 模块，无需单独安装

  // ❌ 密钥输出格式不支持 openssh
  
  var crypto = require("crypto");
  
  
  var { publicKey, privateKey } = crypto.generateKeyPairSync("rsa", {
      modulusLength: 1024,            // 密钥位数，即模数（modulus）的位数，常见的有 512 位、1024 位、2048 位、3072 位和 4096 位
      publicExponent: 65537,          // 公钥指数，默认 65537（0x10001），该值是除了 1、3、5、17、257 之外的最小素数
          publicKeyEncoding: {
          type: "spki",               // 公钥语法标准，支持 pkcs1、spki
          format: "pem"               // 公钥输出格式，支持 pem、der、jwk
      },
      privateKeyEncoding: {
          type: "pkcs1",              // 私钥语法标准，支持 pkcs1、pkcs8
          format: "pem",              // 私钥输出格式，支持 pem、der、jwk
          // cipher: "aes-256-cbc",   // 可选参数，私钥加密的算法，如 aes-256-cbc、des-ded3-cbc 等，如果私钥加密了，则使用时需要先解密
          // passphrase: "spiderapi"  // 可选参数，私钥加密的密码
      }
  });
  
  console.log("RSA 公钥（spki、pem）：\n\n", publicKey);
  console.log("RSA 私钥（pkcs1、pem）：\n\n", privateKey);
  
  
  /*
  RSA 公钥（spki、pem）：
  
  -----BEGIN PUBLIC KEY-----
  MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDki91MwofoyFW+TPdkDLjvww9q
  GjKzgzbEhTUrl5qBwjWQo/yr1nhbTC4i9Qso8XJS8350cwz2ixbkE0QJgdPtL8d2
  lLUIVDxTy8uAFITvYie7rHNanjPyB2ytnm8p85EyYKZnAlq5V3w9hNAM5XxGnffi
  y4PiS7OlhAdVLZM32QIDAQAB
  -----END PUBLIC KEY-----
  
  RSA 私钥（pkcs1、pem）：
  
  -----BEGIN RSA PRIVATE KEY-----
  MIICXQIBAAKBgQDki91MwofoyFW+TPdkDLjvww9qGjKzgzbEhTUrl5qBwjWQo/yr
  1nhbTC4i9Qso8XJS8350cwz2ixbkE0QJgdPtL8d2lLUIVDxTy8uAFITvYie7rHNa
  njPyB2ytnm8p85EyYKZnAlq5V3w9hNAM5XxGnffiy4PiS7OlhAdVLZM32QIDAQAB
  AoGBAJon0QxOhne4cUVcCt5cSn3Gl2Yc56f30IA7zYJqztfJVHIMeoi5sBL8zn3b
  xTxHp7JV9Sy80biWVsleSV0USgoDCkTZqgJTq7pTeUg+LTRSplPb00sm1/gyS7fU
  vwYtCDA8E/4NaG+gCdHAH4TDUOy2JPXF4L3VOBiDpaB+aB0BAkEA8f1qIOWQv7EY
  QNPdbMx9+/2miR/DoPtyyus1Nb+FTNzcZE0/JP8NLJUh7cBhtvRRi0RzhsOYMwK6
  ypCUDZ4Q+QJBAPHHMzOiFlqIedrgZxiGUTZiGovMhBd3OKVYJj8Zr7BbM7TBkf9o
  U3v0LgMhFV7DEt/JXcwlexKmudYufyyo9eECQBwh7OukJJ7UdNBckRpr752TEIBS
  jAi0EtVaYNY9zL5x0sFqZZPkfuCW+dnNCs8dOjmpnJCnPpN3lsWj50JqBOkCQQDq
  rh0v6AvkkoYdAyZu8qlPrUfxHHG2yT1NmNN++jLDbrMwp5dMH3qxXWFwHiO9GIJw
  f+ewqUzd3MGTeQxuUA5hAkBkkA65Jwhg5DrL7GFLj7m3phyPED+Uk2pP7GJ5vIFf
  QgM7yYJFHvKg/enuc2w2aAni+V8Z4DfwWeDlhPjcPyhb
  -----END RSA PRIVATE KEY-----
  */
  ```
  </code-block>

  <code-block title="生成密钥 2️⃣">
  ```javascript
  // ✅ 安装依赖：npm install node-rsa

  // ❌ 密钥输出格式不支持 jwk、openssh
  // ❌ 不支持对私钥进行签名、加密
  // ❓ 注意：截止 2024.03，该库中公钥语法标准支持 pkcs8，但实际上不存在这种说法，具有争议，正确应该是 spki，参见：https://github.com/rzcoder/node-rsa/issues/208
  
  var NodeRSA = require("node-rsa");
  
  
  var key = new NodeRSA({
      b: 1024,  // 密钥位数，默认 2048，即模数（modulus）的位数，常见的有 512 位、1024 位、2048 位、3072 位和 4096 位
      e: 65537  // 公钥指数，默认 65537（0x10001），该值是除了 1、3、5、17、257 之外的最小素数
  });
  
  // 生成密钥，传入参数格式：语法标准-密钥类型-输出格式，即 scheme-[key_type]-[output_type]
  var publicKey = key.exportKey("pkcs1-public-pem");    // 公钥语法标准支持 pkcs1、pkcs8，输出格式支持 pem、der
  var privateKey = key.exportKey("pkcs8-private-pem");  // 私钥语法标准支持 pkcs1、pkcs8，输出格式支持 pem、der
  
  console.log("RSA 公钥（pkcs1、pem）：\n\n", publicKey);
  console.log("RSA 私钥（pkcs8、pem）：\n\n", privateKey);
  
  
  /*
  RSA 公钥（pkcs1、pem）：
  
   -----BEGIN RSA PUBLIC KEY-----
  MIGJAoGBALBIxnoOWWhdvAzaicfo5UB2DbSEa2u9LPQl0DrZSnQduRPs/EHh0EqC
  QlBBJndqa0QuWAp5In/Q4Sjc2lcF7oB8MEzz1P+D/2M2vy1EunXD8XbMBDbyNAvg
  k6yldcT3jEP1yhZjH9JnvgC9JsBFSjC9pUsZbhFDZwY6XLvw9oF7AgMBAAE=
  -----END RSA PUBLIC KEY-----
  
  RSA 私钥（pkcs8、pem）：
  
   -----BEGIN PRIVATE KEY-----
  MIICeAIBADANBgkqhkiG9w0BAQEFAASCAmIwggJeAgEAAoGBALBIxnoOWWhdvAza
  icfo5UB2DbSEa2u9LPQl0DrZSnQduRPs/EHh0EqCQlBBJndqa0QuWAp5In/Q4Sjc
  2lcF7oB8MEzz1P+D/2M2vy1EunXD8XbMBDbyNAvgk6yldcT3jEP1yhZjH9JnvgC9
  JsBFSjC9pUsZbhFDZwY6XLvw9oF7AgMBAAECgYEAgfs3NZpM/HJZDVU6UIf+OfiS
  BG+7UTas5dzX2/yKNHISHIoaOm3JipbfVJOlTFnQe/Z7/kTxVjNrQhkOeSorf6Ee
  Zg64JAMOxCb3aEJ6jABZUCK5DnBkcBv3qoPI6FrwrZNcTDypUGE6zxFfxehetGlQ
  hyJ4xgddFNXg9oxoTKECQQDnpUujoYCSFITC+UDnMXCcV5LXk0wyicySL1+YeP8o
  ymz3LYUTyR0p1JoMeXdg2VpQ3BVX4QDNRGv9mS79dI+xAkEAwtFv2U3egkUacdNv
  vkWgMSVZc7YtlPdiW91wyVmAqxqFNBOVDOBXcuHcZ1o8mzPMgJVwSkjldvi73Ko5
  s5C66wJBAMVikEVqRMg1O7t38NoPwsk1xiZzmSYnTW3zeB3QXHxBoQAuhYsKgBM4
  2dtvVU3tZ4wnPPiY/bnrZ6m8cdH/FMECQAuhx6TY4mUyzQ5oym446ASnLz0aboRL
  dQL5KMfM4ULWFYfzd13Kc043sBo3qBC4OgifY5H74j+FQGo/e6x+ArsCQQCtogcc
  uKx8DHSON+lPQQfgD9A8vCtJVC7pyzzthMoUbmiGnv+VzbPkfuPaiamdVZy6j6qM
  vuQJ+AB8c5SoY5rb
  -----END PRIVATE KEY-----
  */
  ```
  </code-block>

  <code-block title="生成密钥 3️⃣">
  ```javascript
  // ✅ 安装依赖：npm install jsencrypt

  // ❗ 如果在 Node 环境中使用，会遇到报错 window is not defined，需要在 \node_modules\jsencrypt\bin\jsencrypt.js 添加代码：window = global;
  // ❌ 不支持对私钥进行签名、加密
  // ❌ 密钥输出格式不支持 der、jwk、openssh，仅支持 pem
  // ❌ 公钥语法标准不支持 pkcs1，仅支持 spki
  // ❌ 私钥语法标准不支持 pkcs8，仅支持 pkcs1
  
  var JSEncrypt = require('jsencrypt');
  
  
  var crypt = new JSEncrypt({
      default_key_size: "1024",          // 密钥位数，默认 1024，即模数（modulus）的位数，常见的有 512 位、1024 位、2048 位、3072 位和 4096 位
      default_public_exponent: "010001"  // 公钥指数，默认 65537（0x10001），该值是除了 1、3、5、17、257 之外的最小素数
  });
  
  var publicKey = crypt.getPublicKey();    // 公钥语法标准默认 spki，输出格式默认 pem
  var privateKey = crypt.getPrivateKey();  // 私钥语法标准默认 pkcs1，输出格式默认 pem
  
  console.log("RSA 公钥（spki、pem）：\n\n", publicKey);
  console.log("RSA 私钥（pkcs1、pem）：\n\n", privateKey);

  
  /*
  RSA 公钥（spki、pem）：
  
  -----BEGIN PUBLIC KEY-----
  MIGeMA0GCSqGSIb3DQEBAQUAA4GMADCBiAKBgGq2tRBEpDRG26JrXmBxxThGbufn
  C2yw0biiXUf3BPzPx65TQ5vgiOoOnGYWl3wIhzlACPVWW4gto+nk2elcwin9flDb
  vxtJCiBvEVqAaGb3ceiMe56xFnYs88PnDImzecguMCFmwhpbRpkLuvpF8fW4I2+M
  aa3zON2rB5A2yMAxAgMBAAE=
  -----END PUBLIC KEY-----
  RSA 私钥（pkcs1、pem）：
  
  -----BEGIN RSA PRIVATE KEY-----
  MIICWgIBAAKBgGq2tRBEpDRG26JrXmBxxThGbufnC2yw0biiXUf3BPzPx65TQ5vg
  iOoOnGYWl3wIhzlACPVWW4gto+nk2elcwin9flDbvxtJCiBvEVqAaGb3ceiMe56x
  FnYs88PnDImzecguMCFmwhpbRpkLuvpF8fW4I2+Maa3zON2rB5A2yMAxAgMBAAEC
  gYBd5OTrq3nPhYk7H72qnnApU8/BvEkRGYNuMW5iI7b/utK3UAvs22Ocjb6PFNG1
  EMvqU62OMK3Y5E+VPQd/jV5I8C8n2BymrJ2MexCFow9jKneZYX5OLdRitJw+FAxL
  8OnlLHs4nRlKiWJbdZ2Y/OnlYpAmHpStmAs+2loI/AWsAQJBALNOLJYCgZcm8yOO
  cjnt+Q2gbPUWUfRha+x4oZ9jKFVk/xtYQ9GrWysYyi2IBfFkP362OrAdJHdCpjT+
  6DhA/30CQQCYW8p0mRb0WtNmqLF+W7c+8CbPQ4+YeCnADzldNZkRshg/BgOMM41P
  zVMqYFmlhHepIrno0uA6pNqrDi6Sx8nFAkBoviX1i4lATxSBlNjNVmLCvxBnK568
  b5yoCt//R+Fr4Q/VXX5goQUk69pPNsKh/LnKv5ERCDUhJeIJ2060bePRAkAUSv2P
  RCi7iTFpFgT2GI8ysdfpeU0x+KdO7ngsgwwNQFRcaJemX+NtgqKWHVkzY45wl7B9
  Y0D8bqK1b+EiKbwlAkBB1wPeHe97FJ1QaleMhjDIWLjZZiX1UZYrDbaUbmLwhzmM
  1pXmXbW1K0VxC9jcKpN7htwYvOmXuYdOsGHdG1MW
  -----END RSA PRIVATE KEY-----
  */
  ```
  </code-block>

</code-group>

### Golang <Badge text="1.0+"/>

<code-group>
  <code-block title="依赖库" active>
  </code-block>

  <code-block title="纯源码">
  </code-block>
</code-group>

## 解析密钥
### Python <Badge text="3.0+"/>

<code-group>
  <code-block title="依赖库" active>
  </code-block>

  <code-block title="纯源码">
  </code-block>
</code-group>

### JavaScript <Badge text="Node.js"/> <Badge text="ECMAScript 5.1+"/>

<code-group>
  <code-block title="依赖库" active>
  </code-block>

  <code-block title="纯源码">
  </code-block>
</code-group>

### Golang <Badge text="1.0+"/>

<code-group>
  <code-block title="依赖库" active>
  </code-block>

  <code-block title="纯源码">
  </code-block>
</code-group>

## 加密/解密
### Python <Badge text="3.0+"/>

<code-group>
  <code-block title="依赖库" active>
  </code-block>

  <code-block title="纯源码">
  </code-block>
</code-group>

### JavaScript <Badge text="Node.js"/> <Badge text="ECMAScript 5.1+"/>

<code-group>
  <code-block title="依赖库" active>
  </code-block>

  <code-block title="纯源码">
  </code-block>
</code-group>

### Golang <Badge text="1.0+"/>

<code-group>
  <code-block title="依赖库" active>
  </code-block>

  <code-block title="纯源码">
  </code-block>
</code-group>

## 签名/验签
### Python <Badge text="3.0+"/>

<code-group>
  <code-block title="依赖库" active>
  </code-block>

  <code-block title="纯源码">
  </code-block>
</code-group>

### JavaScript <Badge text="Node.js"/> <Badge text="ECMAScript 5.1+"/>

<code-group>
  <code-block title="依赖库" active>
  </code-block>
</code-group>

### Golang <Badge text="1.0+"/>

<code-group>
  <code-block title="依赖库" active>
  </code-block>

  <code-block title="纯源码">
  </code-block>
</code-group>

## 主要特征

## 常见问题
